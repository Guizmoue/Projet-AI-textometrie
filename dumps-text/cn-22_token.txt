稀土 掘金 稀土 掘金

• 首 页
□ 首 页
□ 沸点
□ 课程
□ 直播
□ 活动
□ 竞赛 商城 APP 插件
□
☆ [ ]
搜索 历史 清空
☆ 创作者 中心
○
写 文章
○
发沸点
○
写 笔记
○
写 代码
○
草稿 箱
创作 灵感 查看 更 多
□ vip
会员
□ 登录
注册

ChatGPT 让 人人 都 是 数据 分析师 : 如何 使用 Code Interpreter

我 的 AI力量
2023 - 07 - 10 5 , 446

[ 474cc1 db4 b ]

OpenA I 终于 开放 Code Interpreter 给 所有 Plus 用户 使用 了 ， 这 是 一个 天 大 的 好 消息 ， 我 迫
不 及待 就 开始 了 测试 ， 测试 结果 也 是 喜出望外 。 由于 Python 代码 的 加持 ， 能 发挥 Code
Interpreter 最 大 能力 的 领域 就是 数据 分析 了 。 普通 的 Excel 数据 分析 根本 不在话下 ， 专业
的 数据 分析 也 可以 通过 跟 ChatGPT 对话 来 进行 ， 彻底 改变 了 数据 分析 的 方式 。

为 了 充分 展示 Code Interpreter 的 能力 ， 我 特地 从 Kaggle 上 找 了 一个 数据集 ， 并 交 给 它 一
系列 从 简单 的 数据 分析 并 生成 图表 到 复杂 的 机器 学习 建模 任务 ， 由浅入深 的 探索 了 Code
Interpreter 的 能力 。

不 管 你 日常 使用 Excel 进行 数据 分析 ， 还是 用 Python 代码 ， 都 能 从 这个 案例 知道 如何 使用
Code Interpreter 以及 它 的 能力 。

这个 数据集 是 关于 奈飞 ( Netflix ) 8000 多 部 电影 和 电视 的 数据 ， 包括 导演 ， 演员 ， 评级 ，
发布 时间 ， 观看 时间 ， 节目 类型 ， 节目 描述 等 数据 。

我 会 首先 介绍 如何 安装 Code Interpreter ， 然后 一步步 让 它 完成 从 简单 到 复杂 的 数据 分析
任务 。 最后 ， 我 对 Code Interpreter 对 数据 分析 领域 的 影响 和 它 本身 的 限制 做 了 一个 总结
。

如何 安装 Code Interpreter

目前 ChatGPT 的 代码 解释器 ( Code Interpreter ) 的 使用 前提 是 要 有 ChatGPT Plus 账号 。 登
录ChatGPT 以后 ， 点击 左下角 用户 名 右边 的 三 个 点 形状 的 按钮 ， 打开 ChatGPT 的 设置 窗口 。

[ 5 c 77bc 5 b 15 ]

[ 702ff0942b ]

在 新 打开 的 窗口 中 ， 点击 左侧 的 " Beta features " ， 然后 把 右侧 下方 的 Code interpreter切
换 到 打开 状态 。

[ 72 e 2849c9 a ]

关闭 窗口 ， 把 鼠标 悬 停 在 ChatGPT 主界 面上方 的 " GPT - 4 " 按钮 上 ， 然后 在 弹出 的 下拉 菜单 里
选择 " Code interpreter " 。

[ c843 e 393b2 ]

这样 我们 就 成功 激活 了 Code interpreter 。

[ 3 f c01163ad ]

数据 清理 和 预处理

ChatGPT 的 一个 缺陷 是 无法 直接 上 传 文件 ， 必须 要 通过 网页 连 接 或者 第三 方 插件 才 能 读 取文
件 。 然而 有 了 代码 解释器 ( Code Interpreter ) ， 你 可以 直接 上 传 数据 文件 了 。

它 支持 512 M 以内 的 文件 上传 ， 并且 上 传前 还 可以 解 压缩 。 这个 大小 对于 数据 分析 来 说 很 足
够 了 ， 你 可以 上 传 一个 几百万 行 的 cs v 文件 。

激活 了 Code Interpreter 以后 ， 聊天 输入 框内 的 左边 会 出现 一个 加号 ， 点击 它 就 可以 打开
本地 电脑 的 文件 浏览器 了 。

[ f 0373fe07 a ]

我 直接 把 从 Kaggle上下载 的 解压 包 上 传 ， 省 的 再解 压缩 了 。

上传以后 ， 我 就 直接 开始 给 它 任务 了 ：

作为 一个 专业 的 数据 分析员 ， 请 遵循 标准 的 数据 分析 程序 。 让 我们 一 步 一 步 来 。

ChatGPT 在 进行 初步 的 数据 分析 之后 ， 给 出 的 回复 是 这样 的 ：

很 好 ， 让 我们 开始 数据 分析 过程 。 以下 是 我们 通常 遵循 的 步骤 ：

1 . 1 . 数据 收集 ： 在 这种 情况 下 ， 你 已经 提供 了 一个 数据集 。
2 . 2 . 数据 处理 ： 这 包括 数据 清理 ， 处理 缺 失值 ， 以及 其他 必要 的 转换 。
3 . 3 . 探索性 数据 分析 （ EDA ） ： 这 包括 通过 统计 和 可视化 来 了解 数据 的 特征 。
4 . 4 . 建模 （ 如 有 必要 ） ： 根据 分析 的 目标 ， 我们 可能 建立 统计 或 机器 学习 模型 。
5 . 5 . 解释 ： 最后 ， 我们 解释 结果 并 作出 结论 或 建议 。

让 我们 从 第一 步 开始 。 你 提供 了 一个 名 为 archive . zip 的 文件 ， 所以 让 我们 提取 它 并 检
查 其 内容 ， 以 更 好 地 了 解 数据集 。

archive . zip文件 包含 一个 CSV文件 ， 名 为 netflix _ titles . csv 。 这 似乎 是 一个 关于
Netflix 标题 的 数据 集 。

让 我们 继续 进行 数据 分析 过程 的 下 一 步 ， 即 数据 处理 。 我们 将 阅读 CSV文件 ， 看看 前 几
行 ， 以 了 解 它 的 结构 和 它 所 包含 的 数据 类型 。

该 数据 集 包含 以下 几 列 ：

1 . show _ id : 每个 节目 的 唯一 标识符 。
2 . type : 节目 的 格式 （ 电影 或 电视 节目 ） 。
3 . title : 该 节目 的 标题 。
4 . director : 该 节目 的 导演 。
5 . cast : 参与 演出 的 演员 。
6 . country : 制作 该 节目 的 国 家 。
7 . date _ added : 该 节目 被 添加 到 Netflix 的 日期 。
8 . release _ year : 该 节目 最初 发布 的 年份 。
9 . rating : 该 节目 的 评级 。
10 . duration : 该 节目 的 持续 时间 。
11 . listed _ in : 该 节目 的 类型 。
12 . description : 对 该 节目 的 简短 描述 。

在 我们 进一步 进行 分析 之前 ， 检查 数据 是 否 有 缺 失值 或 需要 处理 的 不 一致 之 处 ， 是 有
好处 的 。 让 我们 检查 一下 我们 的 数据 集中 的 缺失值 。

下面 是 每 一 列 中 缺 失值 的 计数 ：

□ director : 2634 个 缺 失值
□ cast : 825 个 缺 失值
□ country : 831 个 缺 失值
□ date _ added : 10 个 缺 失值
□ rating : 4 个 缺 失值
□ duration : 3 个 缺 失值

director , cast , and country 这 几 列 有 相当 多 的 缺 失值 。 根据 我们 的 分析 目标 ， 我们
可以 用 一个 适当 的 值 （ 如 ' 未知 ' ） 来 填补 这些 值 ， 或者 我们 可以 决定 忽略 这些 列 ， 如
果 它们 与 我们 的 分析 不 相关 。

在 date _ added , rating , 和 duration列 中 ， 只有 几 个 缺 失值 。 我们 可以 考虑 删除 这
些 列 中 有 缺 失值 的 行 ， 或者 如果 我们 能 确定 一个 合适 的 值 ， 就 把 它们 填 进去 。

下 一 步 是 探索性 数据 分析 。 然而 ， 我们 需要 先 决定 如何 处理 这些 缺 失值 。 你 想 如何 进
行 ？

如果 你 点击 ChatGPT 的 回复 里面 的 " Show Work " 按钮 ， 就 会 展开 如下 代码 ：

import zipfile
import os

#  Path to the zip file
zip _ path  =   " / mnt / data / archive . zip "
#   Directory to extract to
extract _ dir  =   " / mnt / data / archive / "

#  Create directory to extract to if  it doesn ' t exist
o s . makedirs ( extract _ dir ,  exist _ ok = True )

#  Open  the zip file
with zipfil e . ZipFile ( zip _ path ,   ' r ' )  as  zip _ ref :
      #  Extract all the content s  of  zip file in  the directory
      zip _ ref . extractall ( extract _ dir )

#  List the content s  of  the directory after extraction
content s  =   o s . listdir ( extract _ dir )

content s

[ df 6cfe 2ca7 ]

Code Interpreter 不 仅 为 我们 分析 了 数据 ， 展示 了 分析 过程 ， 同时 还 输出 了 代码 。 对于 会
Python 代码 的 同学 来 说 ， 会 更加 清楚 Code Interpreter 进行 数据 分析 的 底层 逻辑 。 不 懂 代
码 也 没关系 ， Code Interpreter 为 每 一 行 都 添加 了 注释 。

通过 以上 代码 和 注释 ， 你 会 发现 ChatGPT 其 实在解 压缩 文件 这个 环节 也 是 用 了 Python 的 os 和
zipfile库 。 我们 其实 并 未 让 它 解 压缩 ， 一切 都 是 自动 运行 的 。 接 下 来 它 读取 了 各列 的 名称
， 并 用 它 的 理解 对 各个 列名 进行 了 诠释 。 这 也 是 用 ChatGPT 分析 数据 的 一 大 优势 — 它 知道 什
么 是 奈飞 ， 电影 和 电视 这些 话题 ， 所以 能够 帮 我们 比较 准确 的 解读 数据 。

接 下 来 它 把 每 一 列 的 缺 失 数据 的 总和 都 列举 出 来 ， 并且 根据 缺失值 的 数量 和 分析 的 目标 ，
给 了 处理 这些 缺 失值 的 建议 。 因为 如果 有 空 数据 的 话 ， 分析 起 来 可能 会 报错 ， 不 合理 的 数
据 也 会 干扰 分析 的 结果 ， 所以 数据 的 清洗 通常 是 数据 分析 过程 中 一个 非常 重要 的 环节 。

因为 ChatGPT 存在 随机性 ， 有时 它 可能 不 会 给 出 数据 清洗 的 建议 ， 这时候 你 可以 主动 要求 它
给 出 数据 清洗 的 建议 。 也 可以 跳 过 这 一 步 ， 后续 遇到 问题 它 会 自行 清理 ， 谁 叫 它 是 机器 呢
， 不 嫌 麻烦 。 但是 为 了 减少 碳 足迹 ， 我们 就 让 按照 它 给 出 的 建议 清洗 数据 吧 。 于是 我 给 了
它 这样 一个 Prompt :

将 导演 、 演员 和 国 家 的 缺失值 填写 为 " 未知 " ， 并 删除 添加 日期 、 评级 和 观看 时间 的 缺
失值 的 行 。

ChatGPT 是 这样 回复 的 ：

所有 缺 失值 都 已 成功 处理 。 该 数据 集 不 再 包含 任何 缺 失值 。

现在 我们 可以 进入 下 一个 步骤 ： 探索性 数据 分析 （ EDA ） 。 在 这 一 步 ， 我们 将 深入 研究
数据集 ， 了 解 数据 的 分布 ， 不 同 变量 之间 的 关系 ， 并 确定 任何 有趣 的 模式 或 见解 。

你 想 在 这个 数据 集中 探索 哪 些 具体 方面 ？ 例如 ， 我们 可以 看看 电影 与 电视 节目 的 分布
， 分析 多 年 来 增加 的 内容 ， 或者 看看 哪 些 国 家 生产 的 内容 最 多 ， 等等 。

探索性 数据 分析 ( EDA )

如果 把 数据 看作 一个 拼图 的 话 ， EDA 就是 拼图 的 第一 步 。 它 帮助 我们 了 解拼图 的 大概 样子 ，
找到 重要 的 部分 ， 并 开始 建立 联系 。

EDA 在 数据 分析 中 起 着 至关重要 的 作用 ， 因为 它 可以 帮助 我们 初步 熟悉 数据集 ， 并 确定 可以
为 进一步 分析 提供 信息 的 关键 特征 。 例如 ， 在 市场 营销 中 ， EDA 可以 帮助 识别 客户群 ， 了 解
购买 模式 ， 并 发现 市场 趋势 。 在 医疗 保健 领域 ， 它 可以 揭示 病人 数据 的 模式 ， 识别 风险 因
素 ， 并 帮助 进行 疾病 诊断 。 在 金融 领域 ， EDA 可以 帮助 分析 市场 趋势 ， 识别 投资 机会 ， 并 检
测 欺诈 。

既然 Code Interpreter 告诉 我们 下 一 步 它 将 探索 数据 ， 那 么 就 让 它 这样 进行 吧 ：

作为 一个 专业 的 数据 分析师 ， 请 自己 做出 决定 。

它 这样 回复 ：

好 吧 ， 让 我们 从 探索 数据 的 一 般 方面 开始 。 以下 是 我们 可以 采取 的 几 个 步骤 ：

1 . 1 . 类型 分布 （ 电影 与 电视 节目 ） ： 这 可以 让 我们 了 解 到 Netflix 上 最 普遍 的 那种
内容 。
2 . 2 . 逐年 增加 的 内容 ： 这 项 分析 可以 让 我们 看到 Netflix 上 增加 的 内容 随 时间 推移
的 趋势 。
3 . 3 . 按 国 家 划分 的 内容 生产 ： 这 可以 告诉 我们 哪 些 国 家 是 Netflix 上 的 主要 内容 生
产国 。
4 . 4 . 评级 分布 ： 这 可以 让 我们 了 解Netflix 上 最 普遍 的 内容 种类 （ 就 成熟度 评级 而
言 ） 。

让 我们 从 类型 的 分布 开始 （ 电影 与 电视 节目 ） 。

[ 88 f 325fe91 ]

该图 显示 ， 数据 集中 的 电影 比 电视 节目 多 ， 表明 Netflix 的 电影 收藏量 比 电视 节目 多 。

接 下 来 ， 让 我们 分析 一下 这些 年 Netflix 上 内容 的 增加 趋势 。 要 做到 这 一 点 ， 我们 首先
需要 从 date _ added列 中 提取 年份 。 注意 ， 我们 目前 的 数据 是 一个 字符串 ， 所以 我们 要
把 它 转换 成 日期 时间 格式 ， 然后 再 提取 年份 。

[ f 471b59 b 79 ]

该图 显示 了 每年 添加 到 Netflix 的 电影 和 电视 节目 的 数量 。 我们 可以 看到 多 年 来 内容 增
加 的 明显 趋势 ， 2016年 前后 增加 的 电影 数量 明显 增加 ， 每年 增加 的 电视 节目 数量 也 在
稳步 增加 。 从 2018年 到 2020年 ， 增加 的 内容 有 一个 特别 明显 的 上升 。

接 下 来 ， 让 我们 看看 哪 些 国 家 生产 的 内容 最终 出现 在 Netflix 上 。 由于 一些 节目 列出 了
多 个 国 家 ， 我们 需要 将 这些 条目 拆分 ， 以 获得 准确 的 计数 。 为 了 这 次 分析 的 目 的 ， 我
们 将 考虑 前 10 个 国 家 。

[ 98e1ada9 f 4 ]

柱状图 显示 了 Netflix 上 的 内容 生产 数量 的 前 10 个 国 家 。 到 目前 为止 ， 美国 是 最 大 的 生
产国 ， 其次 是 印度 、 英国 、 加拿大 和 法国 。

最后 ， 让 我们 看 一下 Netflix 上 的 内容 评级 分布 。 这 可以 提供 一个 关于 目标 受众 在 年龄
组 和 内容 成熟度 方面 的 想法 。

[ 12 b 7 f 784e9 ]

该图 显示 了 Netflix 上 内容 评级 的 分布 。 最 常见 的 评级 是 " TV - M A " ， 这 是 为 成熟 的 观众
准备 的 ， 其次 是 " TV - 14 " ， 适合 14 岁 以上 的 儿童 ， 以及 " TV - PG " ， 这 表明 有 家 长 监督
。

我们 的 探索性 数据 分析 到 此 结束 。 这些 见解 使 我们 对 数据集 和 Netflix 上 的 内容 类型 有
了 很 好 的 了解 。

你 想 继续 进行 建模 ， 或者 在 数据 集中 还有 什 么 想 探索 的 吗 ？ 建模 通常 是 为 预测 或 分类
任务 做 的 ， 如果 我们 的 目标 只是 了 解 数据集 ， 可能 就 没有 必要 了 。

Code Interpreter 根据 它 对 数据 内容 和 分析 目标 的 理解 ， 从 4 个 角度 给 出 了 探索性 分析 。 这
些 角度 确实 是 很 好 的 切入口 ， 让 我们 能 很快 地 了 解数 据集 的 大概 情况 ， 为 后面 更 深入 的 分
析 做 了 铺垫 。

在 分析 过程 中 ， 它 会 根据 分析 目标 自动 转换 数据 类型 ， 比如 把 字符串型 的 日期 格式 转化 为
pandas 日期 对象 以便 通过 Python 的 Pandas库 处理 数据 。 它 还 根据 分析 目标 自动 生成 了 图表
， 并 给 出 了 分析 的 结论 ， 虽然 我们 并 没有 要求 它 这 么 做 。 默认 情况 下 ， 如果 柱状图 可以 展
示 数据 ， 它 生成 的 就 是 柱状图 ， 你 也 可以 要求 它 换 一 种 图表 类型 。

最后 ， 它 列出 了 后续 的 步骤 ， 是 继续 探索 数据 还是 开始 建模 。

Code Interpreter 的 EDA 做 的 还是 很 完善 的 ， 我 其实 只是 让 它 根据 自己 的 经验 来 操作 。 对于
一 开始 拿 到 数据 并 没有 分析 思路 的 人 来 说 ， Code Interpreter 为 我们 做 了 很多 辛苦 的 工作
， 虽然 它 并 不 觉得 累 。

接 下 来 我们 给 它 一些 其它 的 分析 视角 看看 它 的 表现 。

我 ：

分析 电影 的 持续 时间 。

ChatGPT :

持续 时间 一 栏 包含 电影 的 长度 （ 分钟 ） 和 电视 节目 的 季数 。 为 了 分析 电影 时长 ， 我们
首先 需要 把 电影 和 电视 节目 分开 。 然后 ， 我们 可以 查看 电影 时长 的 分布 ， 找 出 最 短 、
最 长 和 平均 的 电影 时长 。

让 我们 先 把 电影 分开 ， 提取 以 分钟 为 单位 的 持续 时间 。

这里 有 一些 关于 Netflix 上 电影 时长 的 统计 数据 ：

□ 最 短 的 电影 是 3 分钟 长 。
□ 最 长 的 电影 是 312 分钟 长 。
□ 电影 的 平均 长度 约 为 100 分钟 。
□ 第25 个 百分点 （ 即 25 % 的 电影 比 这个 长度 短 ） 是 87 分钟 。
□ 第50 个 百分位数 ， 或 中位数 （ 即 一半 的 电影 比 这个 长度 短 ） 是 98 分钟 。
□ 第75百分位数 （ 即 75 % 的 电影 比 这个 长度 短 ） 是 114 分钟 。

这些 统计 数据 提供 了 一个 关于 电影 长度 的 一 般 概念 。 然而 ， 将 分布 可视化 可以 提供 一
个 更 直观 的 理解 。 让 我们 绘制 一个 电影 长度 的 直方 图 。

[ bef 2755453 ]

该 直方图 显示 了 Netflix 上 电影 时长 的 分布 。 大多数 电影 的 长度 在 80 到 120 分钟 之间 ，
峰值 在 90 - 100 分钟 左右 。 极 短 或 极长 的 电影 较 少 ， 这 一 点 从 分布 的 两端 的 下降 趋势 可
以 看出 。

对 电影 长度 的 分析 到 此 结束 。 在 这个 数据 集中 ， 你 还 有什 么 想 探讨 的 吗 ？

我 ：

向 我 展示 节目 类型 和 它们 的 数量 之间 的 关系

ChatGPT :

为 了 分析 节目 类型 和 它们 的 数量 之间 的 关系 ， 我们 首先 需要 分割listed _ in列 ， 因为 每
个 条目 可以 包含 由 逗号 分隔 的 多 个 节目 类型 。

让 我们 计算 每个 节目 类型 的 出现 次数 ， 并 将 结果 可视化 。 在 这个 分析 中 ， 我们 将 考虑
所有 类型 ， 而 不 仅仅 是 电影 或 电视 节目 的 类型 。

[ 1 ef 986ff 7 e ]

柱状图 显示 了 Netflix 的 内容 按 类型 的 计数 。 " 国际 电影 " 、 " 电视剧 " 和 " 喜剧 " 等 类
型 的 计数 最高 ， 意味着 它们 是 Netflix 上 最 常见 的 内容 类型 。

我们 对 节目 类型 及其 计数 的 分析 到 此 结束 。 在 这个 数据 集中 ， 你 还 有什 么 想 要 探索 的
吗 ？

自然 语言 处理

接 下 来 我们 看看 Code Interpreter 能 否 用 自然 语言 处理 ( NLP ) 来 处理 和 分析 数据 。 NLP 是
一个 研究 领域 ， 专注 于 使 计算机 能够 理解 人类 语言 并 与 之 互动 ， 其 方式 类似 于 我们 彼此 之
间 的 沟通 方式 。 它 允许 计算机 处理 、 分析 并 从 大量 的 文本 数据 中 获得 洞察力 。 ChatGPT 就 是
利用 NLP 技术 进行 语言 建模 、 理解 句法 和 语义 关系 、 处理 情感 分析 。 这些 NLP 能力 使 ChatGPT
能够 进行 类似 人类 的 对话 ， 并 根据 它 收到 的 输入 提供 有 意义 的 回应 。

Code Interpreter 可以 使用 Python 的 一个 非常 流行 的 NLP 的 库NLTK （ 自然 语言 工具包 ） 。 可
以 用 来 执行 广泛 的 NLP 任务 ， 如 标记化 、 部分 语音 标记 、 命名 实体 识别 、 情感 分析 和 文本 分
类 。 通过 利用 NLTK ， 没有 丰富 数据 分析 经验 的 人 也 可以 有效 地 处理 和 分析 文本 数据 。

比如 我 给 它 这样 一个 任务 ：

分析 标题 中 最 频繁 的 词 。

通过 分析 词频 的 方法 ， 我们 可以 把 文本 中 单词 的 出现 频率 计算 并 展示 出 来 ， 从而 可以 帮 我
们 快速 了 解 文本 中 的 主要 内容 。

我们 来 看 下 ChatGPT ( Code Interpreter ) 的 输出 ：

分析 标题 中 最 常见 的 单词 可以 深入 了 解 流行主题 或 趋势 。 例如 ， “ 爱 ” 、 “ 战争 ” 、 “ 世界
” 等 词语 可能 表示 内容 中 涵盖 的 常见 主题 。

我们 首先 从 “ 标题 ” 列 中 提取 所有 单词 ， 然后 计算 每个 单词 的 频率 。 为 了 获得 有 意义 的
结果 ， 我们 将 排除 不 提供 太 多 信息 的 常见 英语 单词 （ 例如 “ the ” 、 “ a ” 、 “ and ” ） 。 这些
被 称为 “ 停 用 词 ” 。 让 我们 找 出 最 常用 的 20 个 单词 。

对于 给 您 带 来的不便 ， 我们 深表 歉意 ， 由于 当前 环境 的 权限 有限 ， 我 似乎 无法 下载 该
组 英文 停 用 词 。

解决 方法 是 手动 定义 一 组 基本 的 英语 停 用 词 。 该 集合 不 会 像 NLTK 提供 的 那样 全面 ，
但 它 应该 适合 我们 的 目 的 。 让 我们 继续 采用 这种 方法 。

[ 74 f 63cb 433 ]

条形图 显示 了 排除 一 组 基本 的 英语 停 用 词 后 Netflix 影片 中 最 常见 的 20 个 单词 。

“ 爱 ” 、 “ 男人 ” 、 “ 世界 ” 、 “ 生活 ” 和 “ 故事 ” 等 词 是 最 常见 的 ， 这 表明 这些 主题 在
Netflix 内容 中 很 普遍 。

请 记住 ， 此 分析 可能 会 受到 未 包含 在 我们 的 基本 停 用 词 集中 的 其他 常 用 词 的 影响 。

您 还 想 在 这个 数据 集中 探索什 么 吗 ？

由于 Code Interpreter 所在 的 沙盒 环境 缺少 更 多 停止 词 的 语料 包 ， 所以 它 并 没有 排除 像 ' &
' , ' - ' , ' with ' , ' i ' 这样 对 分析 词频 毫无 意义 的 停止 词 。 那 我们 就 把 不 想 要 的 停止 词 提
交 给 ChatGPT ， 让 它 排除 掉 吧 。 而且 词频 通常 通过 词云 才 能 获得 更 好 的 展示 效果 ， 于是 我 提
交 了 如下 Prompt :

请 删除 停 用 词 ' & ' 、 ' my ' 、 ' 2 ' 、 ' with ' 、 ' i ' 、 ' on ' 、 ' you ' 、 ' man ' 、 ' little ' 、
' one ' 、 ' - ' 、 ' from ' 。 使用 词云 展示 。

ChatGPT 的 输出 如下 ：

[ c 26eeed0 d 7 ]

词云 提供 了 Netflix 影片 中 最 常见 单词 的 视觉 表示 ， 每个 单词 的 大小 与 其 频率 相对 应
。 “ 爱 ” 、 “ 世界 ” 、 “ 生活 ” 、 “ 故事 ” 、 “ 女孩 ” 、 “ 婴儿 ” 和 “ 圣诞节 ” 等 常用 词 尤其 突出 ，
表明 这些 主题 在 Netflix 内容 中 很 普遍 。

请 记住 ， 词云 中 单词 的 确切 位置 和 颜色 是 随机 生成 的 ， 不 具有 任何 意义 。 重要 的 方面
是 单词 的 相对 大小 。

您 还 想 在 这个 数据 集中 探索什 么 吗 ？

时间 序列 分析

时间 序列 分析 可以 帮助 我们 理解 随 时间 变化 的 数据 模式 和 趋势 。 通过 分析 和 理解 这些 模式
， 我们 可以 做出 有 价 值 的 决策 ， 以及 预测 未 来 。 例如 ， 在 金融 领域 ， 时间 序列 分析 有助于
根据 历史 数据 预测 股票 价 格 或 市场 趋势 。 在 天气 预报 中 ， 它 使 我们 能够 预测 温度 变化 或 降
雨 模式 。

我们 来 让 Code Interpreter 帮 我们 分析 电视 / 电影 的 节目 类型 是 如何 随着 时间 变化 的 。

我 的 Prompt :

观察 电影 和 电视 节目 的 类型 如何 随着 时间 的 推移 而 变化 。

ChatGPT 的 回答 ：

分析 电影 和 电视 节目 的 类型 如何 随着 时间 的 推移 而 变化 ， 可以 深入 了 解 观众 偏好 或 内
容 制作 策略 的 趋势 和 变化 。

为此 ， 我们 需要 ：

1 . 电影 和 电视剧 分开 。
2 . 拆 分 “ listed _ in ” 列 ， 因为 每个 条目 可以 包含 多 个 节目 类型 。
3 . 按 “ release _ year ” 分组 并 统计 每年 每种 类型 的 频率 。

我们 先 从 电影 开始 吧 。 为 了 清楚 起见 ， 我们 将 随着 时间 的 推移 绘制 排名 前 5 的 节目 类
型 。

[ 904 b 49 a 39 a ]

折线图 显示 随 时间 变化 的 前 5 种 类型 的 电影 数量 。 类型 包括 “ 国际 电影 ” 、 “ 剧情片 ” 、
“ 喜剧 ” 、 “ 纪录片 ” 和 “ 动作 与 冒险 ” 。

我们 可以 观察 到 ， “ 国际 电影 ” 、 “ 剧情片 ” 和 “ 喜剧 ” 的 数量 逐年 显 着 增加 ， 特别 是 2000
年 以后 。 “ 纪录片 ” 也 有 增加 ， 但 幅度 不 大 。 多 年 来 ， “ 动作 与 冒险 ” 类型 一直 保持 相对
稳定 。

接 下 来 ， 我们 对 电视剧 进行 同样 的 分析 。

[ 85b746b070 ]

折线图 显示 随 时间 变化 的 前 5 种 类型 的 电视 节目 数量 。 类型 包括 “ 国际 电视 节目 ” 、 “
电视剧 ” 、 “ 喜剧 电视 节目 ” 、 “ 犯罪 电视 节目 ” 和 “ 儿童 电视 节目 ” 。

我们 可以 看到 ， “ 国际 电视 节目 ” 、 “ 电视剧 ” 和 “ 电视 喜剧 ” 的 数量 逐年 显 着 增加 ， 特别
是 2010年 之后 。 “ 犯罪 电视 节目 ” 和 “ 儿童 电视 节目 ” 也 有所 增加 ， 但 没有 那 么 明显 。

这些 趋势 表明 Netflix 制作 和 添加 的 内容 类型 发生 了 变化 ， 电影 和 电视 节目 的 国际 内
容 和 戏剧 明显 增加 。

您 还 想 在 这个 数据 集中 探索什 么 吗 ？

统计 推断

统计 推断 ( Statistical Inference ) 这种 方法 根据 有限 的 数据 样本 得出 结论 并 对 总体 进行
预测 。 通过 使用 假设 检验 和 置信 区间 等 统计 技术 ， 我们 可以 量化 与 我们 的 估计 相关 的 不 确
定性 。

我们 来 看 下 发行 时间 ( release _ year ) 和 添加 时间 ( date _ added ) 这 两 列 数据 是 否 存在 相
关性 。 我 给 ChatGPT 这样 一个 问题 ：

执行 相关性 检测 以 查看 “ release _ year ” 和 “ date _ added ” 之间 是 否 存在 显 着 的 线性 关系
。

ChatGPT 这样 回复 ：

要 执行 相关性 检验 ， 我们 需要 确保 两 个 变量 都 是 数值 变量 。 ' release _ year ' 已经 是
数字 ， 但 ' date _ added ' 是 一个 日期 时间 对象 。 我们 需要 从 “ date _ added ” 中 提取 年份
并 将 其 用于 我们 的 相关性 测试 。

皮尔逊 相关 系数 可以 用 来 衡量 两 个 变量 之间 线性 关系 的 强度 和 方向 。 取值 范围 为 - 1 到 1
。 接近 1 的 值 表示 强 正 关系 ， 接近 - 1 的 值 表示 强 负 关系 ， 接近0 的 值 表示 没有线性 关系
。

让 我们 计算 “ release _ year ” 与 该 节目 添加 到 Netflix 的 年份 之间 的 皮尔逊 相 关系数 。
“ release _ year ” 和 “ year _ added ” 之间 的 Pearson 相 关系数 约 为 0 . 11 。 这 表明 这 两 个
变量 之间 存在 弱正线性 关系 。

换句话说 ， 节目 在 临近 上映 年份 时 有 轻微 的 趋势 被 添加 到 Netflix ， 但 这种 关系 并 不
是 很 强 。 其他 因素 （ 例如 许可 协议 和 内容 策略 ） 很 可能 在 决定 节目 何时 添加 到
Netflix 时 发挥 重要 作用 。

您 还 想 在 这个 数据 集中 探索什 么 吗 ？

数据 挖掘

数据 分析 中 的 数据 挖掘 是 指 从 大型 复杂 数据 集中 提取 有用 的 信息 并 发现 可以 指导 决策 的 隐
藏 关系 或 趋势 。 它 使 我们 能够 发现 原本 可能 隐藏 的 有 价 值 的 信息 ， 从而 更 好 地 理解 并 做出
明智 的 决策 。 例如 ， 在 零售业 ， 数据 挖掘 可以 帮助 识别 客户 购买 行为 的 模式 ， 从而 使 企业
能够 制定 个性化 营销 策略 并 提高 销售额 。 在 医疗 保健 领域 ， 它 可以 帮助 分析 患者 记录 以 发
现 风险 因素 或 预测 疾病 结果 ， 从而 实现 更 好 的 医疗 保健 管理 。

让 我们 发现 导演 和 节目 类型 这 两 组 数据 之间 是 否 存在 隐藏 的 关系 。

发现 导演 和 节目 类型 之间 的 关联 。

ChatGPT 的 回复 ：

分析 导演 和 节目 类型 之间 的 关联 可以 深入 了 解 某些 导演 为 人们 所 熟知 的 特定 内容 类型
。

为此 ， 我们 需要 ：

1 . 拆 分 “ 导演 ” 列 ， 因为 每个 条目 可以 包含 多 个 以 逗号 分隔 的 导演 。
2 . 拆 分 “ listed _ in ” 列 ， 因为 每个 条目 可以 包含 多 个 节目 类型 。
3 . 按 “ 导演 ” 分组 并 统计 每种 类型 的 频率 。

但是 ， 请 注意 ， 这个 操作 可能 会 导致 数据量 太 大 ， 因为 有 许多 独特 的 导演 和 节目 类型
。 为 了 便于 分析 ， 我们 来 看看 执导 过 最 多 剧集 的 前 20 名 导演 。

让 我们 继续 采用 这种 方法 。

上 表 代表 了 前 20 名 导演 （ 执导 过 最 多 节目 的 导演 ） 与 其 节目 类型 之间 的 关联 。 每个
单元格 代表 导演 在 特定 类型 中 的 演出 数量 。

例如 ， 凯茜 · 加西亚 - 莫利纳 ( Cathy Garcia - Molina ) 执导 了 7 部 “ 喜剧 ” 类型 的 节目
， 而 苏 哈 斯 · 卡达夫 ( Suhas Kadav ) 执导 了 16 部 “ 儿童 和 家 庭 电影 ” 类型 的 节目 。

为 了 更 好 地 可视化 这些 数据 ， 我们 可以 生成 热图 。 热图 可以 帮助 我们 了 解 节目 在 导演
和 节目 类型 方面 最 集中 的 地方 。 让 我们 继续 吧 。

[ 89707b03 a 1 ]

热图 直观 地 展示 了 排名 前 20 位 的 导演 （ 执导 过 最 多 节目 的 导演 ） 与 其 节目 类型 之间
的 关联 。 每个 单元格 中 的 颜色 强度 代表 导演 在 特定 类型 中 的 演出 数量 。 较 暗 的 单元格
表示 显示 次数 较 多 。

例如 ， 热图 显示 导演 Suhas Kadav 与 “ 儿童 和 家 庭 电影 ” 类型 特别 相关 ， 而 Rajiv
Chilaka 与 “ 儿童 电视 ” 类型 特别 相关 。 导演 凯茜 · 加西亚 - 莫利纳 ( Cathy
Garcia - Molina ) 与 “ 喜剧 ” 相关 ， 阿 努拉格 · 卡什亚普 ( Anurag Kashyap ) 与 “ 惊悚片 ”
相关 。

请 记住 ， 一 位 导演 可以 与 多种 类型 相 关联 ， 并且 此 分析 仅 包括 根据 他们 执导 的 节目 数
量 排名 前 20 位 的 导演 。

您 还 想 在 这个 数据 集中 探索什 么 吗 ？

机器 学习 建模

数据 分析 中 的 机器 学习 建模 是 指 训练 计算机 算法 自动 学习 模式 并 根据 输入 数据 做出 预测 或
决策 的 过程 。 该 模型 可以 对 新 的 、 未 见 过 的 数据 进行 概括 并 做出 准确 的 预测 。

Code Interpreter 利用 Pyton 丰富 的 机器 学习库 来 建模 ， 比如 scikit - l earn 。 在 这个 例子 中
， 我 问 ChatGPT 它 可以 建 哪 些 模型 ：

您 可以 为此 数据 集 构建 哪 些 机器 学习 模型 ？

ChatGPT 这样 回复 ：

机器 学习 模型 的 选择 取决于 您 感 兴趣 的 具体 问题 或 任务 。 以下 是 一些 潜在 的 任务 以及
可以 使用 的 相应 模型 ：

内容 推荐 ： 如果 您 有 兴趣 根据 用户 的 观看 历史 记录 向 用户 推荐 类似 的 内容 ， 则 可以 使
用 协作 过滤 模型 （ 如 矩阵 分解 ） 或 基于 内容 的 过滤 模型 （ 根据 项目 属性 推荐 类似 的 项
目 ） 。

类型 预测 ： 如果 您 想 根据 其他 特征 （ 如 导演 、 演员 、 描述 ） 来 预测 电影 或 电视 节目 的
类型 ， 您 可以 使用 监督 学习 模型 。 这些 可能 包括 决策 树 、 随机 森林 、 支持 向 量机 或 神
经 网络 。

情绪 分析 ： 如果 您 想 预测 用户 评论 的 情绪 ， 您 可以 使用 自然 语言 处理 模型 ， 如 朴素贝
叶斯 、 逻辑 回归 ， 甚至 更 复杂 的 模型 ， 如 循环神经 网络 ( RNN ) 或 Transformer 。

趋势 预测 ： 如果 您 有 兴趣 预测 未 来 趋势 （ 例如 特定 类型 的 电影 或 电视 节目 的 数量 ） ，
您 可以 使用 ARIMA 或 指数 平滑 等 时间 序列 预测 模型 。

请 注意 ， 这些 模型 的 有效性 在 很 大 程度 上 取决于 数据 的 质量 和 数量 ， 以及 特征 工程 和
模型 调整 步骤 。 此外 ， 应 仔细 进行 模型 解释 和 评估 ， 以 避免 过度 拟 合并 确保 模型 能够
很 好 地 推广 到 未 见 过 的 数据 。

如果 您 有 兴趣 的 特定 任务 或 问题 ， 请 告诉 我 ， 我 可以 提供 更 详细 的 建议 。

虽然 我们 的 数据量 不 大 ， 才 8千 多 行 ， 也 可以 让 Code Interpreter 建 几 个 模型 ， 看 它 是 否 在
吹牛 。 我 提交 了 如下 Prompt :

利用 文本 数据 （ 如 标题 和 描述 ） 和 分类 数据 （ 如 导演 、 演员 、 国 家 / 地区 和 评级 ） 构建
基于 内容 的 推荐 系统 。

来 看看 ChatGPT 的 回复 ：

当然 ， 我们 可以 构建 一个 基于 内容 的 推荐 系统 。 基于 内容 的 推荐 系统 通过 使用 项目 特
征 来 提供 推荐 。 在 这种 情况 下 ， 项目 特征 是 电影 或 电视 节目 的 各种 特征 ， 例如 标题 、
描述 、 导演 、 演员 、 国 家 和 评级 。

以下 是 我们 如何 创建 这样 一个 推荐 系统 的 总体 概述 ：

1 . 预处理 ： 此 步骤 涉及 清理 和 准备 模型 中 使用 的 数据 。 这 包括 填充缺 失值 以及 将 文
本 数据 转换 为 模型 可以 使用 的 数字 格式 。
2 . 特征 提取 ： 在 这 一 步 中 ， 我们 将 使用 one - h ot 编码 等 技术 将 分类 数据 转换 为数值
数据 ， 并 使用 TF - IDF 或 CountVectorizer 等 技术 将 文本 数据 转换 为 数值 数据 。
3 . 相似 度 分数 计算 ： 接 下 来 ， 我们 将 计算 不 同 项目 （ 在 本例 中 为 电影 或 电视 节目 ）
之间 的 相似 度 分数 。 计算 相似 度 分数 的 方法 有 多种 ， 例如 余弦 相似 度 、 杰卡德相
似度 或 欧 几 里 德距离 。
4 . 推荐 ： 一旦 我们 有 了 相似 度 分数 ， 我们 就 可以 推荐 与 给 定 项目 最 相似 的 项目 。

让 我们 从 预处理 步骤 开始 。 我们 之前 已经 处理 了 缺失值 ， 因此 我们 可以 继续 将 文本 和
分类 数据 转换 为 我们 的 模型 可以 使用 的 格式 。 为 简单 起见 ， 我们 将 使用
CountVectorizer 技术 ， 它 将 文本 文档 集合 转换 为 标记 计数 矩阵 。 我们 将 其 应用 于 “ 标
题 ” 、 “ 描述 ” 、 “ 导演 ” 、 “ 演员 ” 、 “ 国 家 / 地区 ” 和 “ 评级 ” 列 。

为此 ， 我们 首先 将 这些 列 组合 成 每部 电影 或 电视 节目 的 单个 文本 文档 ， 然后 应用
CountVectorizer 。

CountVectorizer 将 我们 组合 的 文本 数据 转换 为 标记 计数 矩阵 。 生成 的 矩阵 有 8790
行 （ 对应 于 我们 的 8790 部 电影 和 电视 节目 ） 和 53198 列 （ 对应 于 文本 数据 中 的 不同
标记 ） 。

下 一 步 是 计算 不 同 电影 和 电视 节目 之间 的 相似 度 得分 。 有 多种 方法 可以 计算 这些 分数
， 例如 余弦 相似 度 、 杰卡德 相似 度 或 欧 几 里 得 距离 。 在 这里 ， 我们 将 使用 余弦 相似 度
， 这 是 文本 数据 的 常见 选择 。

余弦 相似 度 计算 两 个 向量 之间 角度 的 余弦 。 如果 向量 相同 ， 则 余弦 为 1 （ 对应 于 0 度
的 角度 ） 。 如果 向量 正交 （ 即 根本 不 相似 ） ， 则 余弦 为 0 （ 对应 于 90 度角 ） 。 因此
， 余弦 相似 度 越 接近 1 ， 项目 越 相似 。

让 我们 计算 计数 矩阵 的 余弦 相似 度 分数 。

余弦 相似 度 矩阵 已 成功 创建 。 该 矩阵 的 大小 为 8790x 8790 ， 这 意味着 每 一行 （ 和 每 一
列 ） 对应 于 一 部 电影 或 电视 节目 ， 矩阵 中 的 每个 单元格 包含 两 部 电影 或 电视 节目 之间
的 余弦 相似 度 得分 。

接 下 来 ， 我们 定义 一个 函数 ， 它 将 电影 或 电视 节目 标题 作为 输入 ， 并 输出 最 相似 的 电
影 或 电视 节目 的 列表 。 该 函数 将 执行 以下 步骤 ：

1 . 获取 与 标题 匹配 的 电影 或 电视剧 的 索引 。
2 . 获取 该 电影 或 电视 节目 与 所有 其他 电影 或 电视 节目 的 余弦 相似 度 分数 列表 。 将 此
列表 转换 为 元组 列表 ， 其中 第一 个 元素 是 位置 ， 第二 个 元素 是 相似 度 分数 。
3 . 根据 相似 度 分数 对 元组 列表 进行 降序 排序 。
4 . 获取 排序 列表 的 顶部 元素 。
5 . 返回 顶部 元素 对应 的 标题 。

推荐 系统 似乎 按 预期 工作 。 对于 电影 《 盗梦空间 》 ， 它 推荐 了 以下 10 部 电影 ：

1 . Final Account
2 . The World Is Not Enough
3 . The Last Shaman
4 . 9
5 . Mars Attacks !
6 . Dead in a Week ( Or Your Mone y Back )
7 . High Risk
8 . Catch Me If You Can
9 . Snowden
10 . A Bridge Too Far

这些 推荐 基于 内容 特征 的 相似性 ， 例如 标题 、 描述 、 导演 、 演员 、 国 家 / 地区 和 评级 。

您 想 用 另 一 部 电影 或 电视 节目 标题 来 测试 推荐 系统 吗 ？

总体 而言 ， 它 构建 的 基于 内容 的 推荐 系统 所 采用 的 方法 是 可靠 的 。 使用 CountVectorizer
将 文本 数据 转换 为 数字 形式 是 一个 不 错 的 选择 。 它 非常 简单 ， 适合 处理 简单 的 计数 功能 。

然而 ， CountVectorizer 潜在 的 弱点 是 只 统计 单词 的 出现 次数 ， 没有 考虑 上下文 ， 这 可能 会
丢失 一些 信息 。 更 完善 的 方法 是 使用 TF - IDF 甚至 Word2Vec 或 Doc2 Vec ， 它们 可以 捕获
更 多 语义 信息 。 Code Interperter 没有 采用 更 复杂 的 方法 可能 是 因为 当前 的 沙盒 环境 无法
加载 更 庞大 的 Python库 或者 算力 的 限制 。

我们 再 来 让 它 建 一个 模型 ：

根据 导演 、 演员 、 国 家 / 地区 、 发行 年份 和 类型 等 特征 预测 电影 的 评级 。

来 看看 ChatGPT 的 回复 ：

预测 电影 评级 是 机器 学习 中 的 一个 常见 问题 ， 通常 被 视为 回归 问题 （ 如果 预测 准确 的
评分 ） 或 分类 问题 （ 如果 预测 评分 类别 ） 。 在 我们 的 例子 中 ， 评级 是 一个 具有 多 个 类
别 的 分类 变量 ， 因此 我们 可以 使用 多 类别 分类 算法 。

一些 适合 此 任务 的 算法 包括 决策 树 、 随机 森林 、 朴素 贝叶斯 、 支持 向 量机 ， 甚至 神经
网络 。 为 了 简单 起见 ， 我们 可以 从 决策 树 分类器 开始 。

然而 ， 在 训练 分类器 之前 ， 我们 需要 对 数据 进行 预处理 。 您 提到 的 功能 （ “ 导演 ” 、 “ 演
员 ” 、 “ 国 家 / 地区 ” 、 “ 发行 年份 ” 、 “ 节目 类型 ” ） 大多 是 分类 的 ， 可能 有 许多 独特 的 值
。 我们 需要 将 它们 转换 为 可以 与 分类器 一起 使用 的 格式 ， 这 通常 涉及 将 分类 变量 编码
为 数字 变量 。

让 我们 首先 更 详细 地 检查 这些 功能 和 目标 变量 （ “ 评级 ” ） 。

这 是 我们 所 拥有 的 ：

□ 有 18 个 独特 的 评级 。 然而 ， 似乎 存在 一些 错误 ， 因为 “ 74 分钟 ” 、 “ 84 分钟 ” 和
“ 66 分钟 ” 不 是 有效 的 评分 。 在 使用 “ 评级 ” 变量 作为 分类 目标 之前 ， 我们 需要 清理
它 。
□ 有 4 , 529 位 独特 的 导演 。 这 是 一个 高 基数 分类 变量 ， 对 其 进行 编码 以 与 分类器 一
起 使用 可能 会 产生 大量 特征 。 我们 可能 需要 考虑 使用 这些 信息 的 其他 方式 ， 例如
将 不 太 常见 的 类别 分组 在 一起 。
□ 大约 有 36 , 440 名 独特 的 演员 。 这 是 一个 很 大 的 数字 ， 处理 这个 功能 可能 会 很 棘
手 。 一 种 选择 可能 是 仅 考虑 主要 演员 （ 例如 ， 列出 的 前 几 个 ） ， 或者 创建 一个 表
示 演员 数量 的 特征 。
□ 有 749 个 独特 的 国 家 。 这 是 另 一个 高 基数 分类 变量 。 与 “ 导演 ” 功能 一样 ， 我们 可
能 需要 将 不 太 常见 的 类别 分组 在 一起 。
□ 有 74 个 独特 的 发行 年份 。 这 是 一个 数值 特征 ， 可以 直接 与 大多数 分类器 一起 使
用 。
□ 有 42 种 独特 的 节目 类型 。 我们 可以 使用 one - h ot 编码 对 该 变量 进行 编码 ， 这 会
向 数据集 添加 42 个 二进制 特征 。

在 进行 进一步 的 预处理 和 模型 训练 之前 ， 我们 需要 清理 “ 评级 ” 变量 并 处理 缺 失值 和 不
正确 的 值 。 接 下 来 我们 就 这样 做 吧 。

我 让 它 继续 。

不 正确 的 评级 已 替换 为 “ 未知 ” 。 清理 后 的 “ 评级 ” 变量 现在 具有 以下 唯一 值 ：

□ ' PG - 13 '
□ ' TV - M A '
□ ' PG '
□ ' TV - 14 '
□ ' TV - PG '
□ ' TV - Y '
□ ' TV - Y 7 '
□ ' R '
□ ' TV - G '
□ ' G '
□ ' NC - 17 '
□ ' Unknown '
□ ' NR '
□ ' TV - Y 7 - F V '
□ ' UR '

这些 代表 用于 对 标题 进行 分类 的 不同 内容 评级 系统 。 有 “ PG - 13 ” 、 “ PG ” 、 “ R ” 、 “ G ” 、
“ NC - 17 ” 、 “ NR ” 和 “ UR ” 等 电影 分级 ， 以及 “ TV - MA ” 等 电视 分级 ， “ TV - 14 ” 、 “ TV - PG ” 、
“ TV - Y ” 、 “ TV - Y 7 ” 、 “ TV - G ” 和 “ TV - Y 7 - FV ” 。

接 下 来 ， 让 我们 讨论 高 基数 分类 特征 。 一 种 常见 的 策略 是 将 不 太 常见 的 类别 分组 为 “ 其
他 ” 类别 。 对于 这个 数据集 ， 我们 可以 将 此 策略 应用 于 “ 导演 ” 、 “ 演员 ” 和 “ 国 家 ” 变量 。
我们 将 为 每个 功能 设置 一个 阈值 ， 出现 频率 低于 该 阈值 的 类别 将 被 分组 到 “ 其他 ” 类别
中 。

之后 ， 我们 将 准备 对 这些 分类 特征 进行 编码 并 准备 用于 训练 分类 模型 的 数据 。

让 我们 继续 这个 计划 。

我 让 ChatGPT 继续 ：

将 不 太 常见 的 类别 分组 为 “ 其他 ” 类别 后 ， 我们 现在 有 ：

□ 13 位 独特 的 导演
□ 大约 459 名 独特 的 演员
□ 60 个 独特 的 国 家
□ 42 种 独特 的 节目 类型

这 仍然 是 一个 很 大 的 类别 ， 特别 是 对于 “ 演员 ” 而言 。 对于 “ 演员 ” 和 “ 节目 类型 ” ， 我们
可能 需要 考虑 其他 方法 ， 例如 仅 考虑 前 几 个 演员 或 主要 类型 。

下 一 步 是 对 这些 分类 特征 进行 编码 。 为此 ， 我们 可以 使用 one - hot编码 或 目标 编码 。
One - h ot 编码 将 显 着 增加 数据 的 维度 ， 尤其 是 对于 高 基数 特征 。 目标 编码 可能 是 更 好
的 选择 ， 因为 它 将 分类 变量 转换 为 单个 新列 并 捕获 有关 目标 变量 的 有 价 值 的 信息 。

然而 ， 在 继续 编码 之前 ， 将 数据 分成 训练集 和 测试集 是 有益 的 。 这样 ， 我们 可以 确保
我们 的 编码 方法 不 会 将 测试 集中 的 信息 泄漏 到 训练 集中 。

让 我们 继续 拆 分 数据 。 为 了 简单 起见 ， 我们 只 考虑 “ director ” 、 “ country ” 和
“ release _ year ” 作为 预测 “ rating ” 的 特征 。 如果 需要 ， 我们 将 在 更 高级 的 分析 中 处理
“ 演员 ” 和 “ 节目 类型 ” 特征 。

我 让 ChatGPT 继续 ：

我们 已 成功 将 数据 拆分 为 包含 7 , 045 个 实例 的 训练集 和 包含 1 , 762 个 实例 的 测试 集
。 每个 实例 都 有 3 个 特征 ： “ 导演 ” 、 “ 国 家 ” 和 “ 发行 年份 ” 。

下 一 步 是 对 分类 特征 进行 编码 。 如前所述 ， 我们 将 为此 使用 目标 编码 。 目标 编码 将 分
类 特征 的 每个 类别 替换 为 该 类别 的 目标 变量 的 平均值 。 例如 ， 如果 “ 导演 A ” 执导 的 电
影 的 平均 评分 为 7 . 5 ， 则 “ 导演 A ” 将 在 “ 导演 ” 功能 中 替换 为 7 . 5 。

让 我们 继续 将 目标 编码 应用 于 “ 导演 ” 和 “ 国 家 ” 特征 。 我们 将 在 训练 数据 上 安装 编码器
， 然后 转换 训练 数据 和 测试 数据 。

我 带 来的不便 表示 歉意 。 category _ encoders 模块 在 此 环境 中 不 可用 。 作为 替代 方案
， 我们 可以 执行 一 种 称为 频率 编码 的 简单 编码 类型 ， 其中 每个 类别 都 被 训练 数据 中 的
频率 替换 。 这种 类型 的 编码 仍然 可以 捕获 有关 目标 变量 的 一些 信息 ， 因为 出现 频率 较
高 的 类别 可能 与 出现 频率 较 低 的 类别 相比 具有 不 同 的 平均 评级 。

让 我们 继续 对 “ 导演 ” 和 “ 国 家 ” 特征 进行 频率 编码 。

我们 已经 使用 频率 编码 成功 地 对 “ 导演 ” 和 “ 国 家 ” 特征 进行 了 编码 。 DataFrame 中 的 “
导演 ” 和 “ 国 家 ” 列 现在 分别 表示 训练 数据 中 每个 导演 和 国 家 / 地区 的 出现 频率 。

以下 是 编码 训练集 和 测试集 的 前 几 行 ：

训练集 ：

导演 国 家 发布 年份
5471 5471 0 . 68 3605 0 . 318524 2017
530 530 0 . 298935 0 . 298935 0 . 318524 2015
5594 0 . 68 3605 0 . 318524 2017
996 0 . 68 3605 0 . 026544 2021
6951 0 . 298935 0 . 298935 0 . 0 20014 0 . 0 20014 2018

测试集 ：

导演 国 家 发布 年份
4970 4970 0 . 68 3605 0 . 318524 2018
3362 3362 0 . 68 3605 0 . 318524 2019
5494 0 . 298935 0 . 298935 0 . 009510 0 . 009510 2017
1688 1688 0 . 298935 0 . 298935 0 . 318524 2020
1349 1349 0 . 298935 0 . 298935 0 . 003549 0 . 003549 2012

接 下 来 ， 我们 需要 对 目标 变量 “ 评级 ” 进行 编码 。 由于 这 是 一个 多 类 分类 问题 ， 我们 可
以 使用 标签 编码 将 每个 唯一 的 评分 简单 地 转换 为 唯一 的 整数 。 之后 ， 我们 可以 训练 我
们 的 分类 模型 。

我 让 ChatGPT 继续 ：

我们 已经 使用 标签 编码 成功 地 对 目标 变量 “ 评级 ” 进行 了 编码 。 每个 唯一 的 评级 都 被 分
配 了 一个 唯一 的 整数 ， 如下 所 示 ：

□ ' G ' : 0
□ ' NC - 17 ' : 1
□ ' NR ' : 2
□ ' PG ' : 3
□ ' PG - 13 ' : 4
□ ' R ' : 5
□ ' TV - 14 ' : 6
□ ' TV - G ' : 7
□ ' TV - M A ' : 8
□ ' TV - PG ' : 9
□ ' TV - Y ' : 10
□ ' TV - Y 7 ' : 11
□ ' TV - Y 7 - F V ' : 12
□ ' UR ' : 13
□ ' Unknown ' : 14

现在 我们 的 数据 已 经过 正确 的 预处理 ， 我们 可以 继续 训练 分类 模型 。 如前所述 ， 我们
将 从 决策 树 分类器 开始 ， 因为 它 简单 且 可 解释 。 让 我们 继续 吧 。

我 让 ChatGPT 继续 ：

对于 造成 的 混乱 ， 我 深表 歉意 。 测试 集中 的 唯一 类 数量 与 整个 数据 集中 的 唯一 类 数量
似乎 存在 差异 ， 导致 分类 报告 不 匹配 。

当 训练集 和 测试 集 不 包含 所有 相同 的 类时 ， 可能 会 发生 这种 情况 ， 这 可能 是 由于 数据
的 随机 分割 而 发生 的 。 在 这种 情况 下 ， 目标 变量 中 似乎 存在 测试 集中 未 表示 的 类 。

为 了 解决 这个 问题 ， 我们 可以 在 “ classification _ report ” 函数 中 指定 “ labels ” 参数 ，
以 确保 它 考虑 所有 可能 的 类 。 让 我们 纠正 这个 问题 并 再次 生成 分类 报告 。

我 为 疏忽 表示 歉意 。 看 来 我 忘记 导入 此 代码 中 使用 的 “ numpy ” 库 。 让 我 纠正 这个 问题 并
再次 生成 分类 报告 。

这 是 决策 树 分类器 的 分类 报告 ：

`precision      recall   f 1 - s core     support

            G          0 . 00          0 . 00          0 . 00             12
NC - 17            0 . 00          0 . 00          0 . 00              0
NR          0 . 14          0 . 06          0 . 09             16
PG          0 . 28          0 . 11          0 . 16              62
PG - 13            0 . 25          0 . 29          0 . 27              87
R          0 . 22          0 . 19          0 . 20            163
TV - 14            0 . 45          0 . 46          0 . 46            414
TV - G          0 . 00          0 . 00          0 . 00             43
TV - MA           0 . 48          0 . 70          0 . 57            662
TV - PG          0 . 28          0 . 08          0 . 13            185
TV - Y           0 . 21          0 . 06          0 . 09             52
TV - Y 7            0 . 50          0 . 11          0 . 18              65
TV - Y 7 - FV          0 . 00          0 . 00          0 . 00              0
UR          0 . 00          0 . 00          0 . 00              0
Unknown          0 . 00          0 . 00          0 . 00               1

micro avg           0 . 42          0 . 42          0 . 42           1762
macro avg           0 . 19          0 . 14          0 . 14           1762
weighted avg           0 . 38          0 . 42          0 . 38           1762 `

该 模型 似乎 难以 预测 某些 类别 ， 例如 “ G ” 、 “ NC - 17 ” 、 “ TV - G ” 、 “ TV - Y 7 - FV ” 、 “ UR ” 和 “ 未
知 ” 。 这 可能 是 由于 这些 类别 在 数据 中 代表性 不 足 。

加权 平均 精度 、 召回率 和 F 1 分数 约 为 0 . 38 至 0 . 42 ， 表明 还有 改进 的 空间 。

这 是 一个 在 可用 特征 的 子集 上 训练 的 简单 模型 ， 它 不 处理 高基数 分类 特征 （ 例如
“ cast ” 和 “ genre ” ） 或 文本 特征 （ 例如 “ description ” ） 。 可以 处理 这些 功能 的 更 复杂
的 模型 可能 能够 实现 更 好 的 性能 。 此外 ， 类 平衡 或 模型 调整 等 技术 也 可以 帮助 改善 结
果 。

我 让 ChatGPT 继续 ：

为 了 提高 模型 的 性能 ， 我们 可以 尝试 更 复杂 的 方法 。 我们 可以 使用 随机 森林 分类器 ，
通过 组合 多 个 决策树 的 预测 ， 它 往往 比 单个 决策 树 表现 得 更 好 。 此外 ， 随机 森林 不 太
容易 出现 过度 拟合 。

然而 ， 我们 应该 注意 到 ， 处理 “ 演员 ” 和 “ 节目 类型 ” 等 高 基数 分类 特征 并 不 简单 。 如 前
所 述 ， 一 种 方法 可能 是 仅 考虑 主要 演员 或 主要 类型 。 为 了 演示 ， 我们 将 排除 这些 功能
并 重点 关注 “ 导演 ” 、 “ 国 家 ” 和 “ 发行 年份 ” 。

让 我们 继续 根据 我们 的 数据 训练 随机 森林 分类器 。 我们 还 将 使用 交叉 验证 来 更 好 地 估
计 模型 的 性能 。

随机 森林 分类器 的 交叉 验证 分数 约 为 ：

□ 0 . 41
□ 0 . 42
□ 0 . 42
□ 0 . 42
□ 0 . 40

这些 分数 代表 分类器 在 数据 的 不同 分区 上 的 准确性 。 正 如 我们 所 看到 的 ， 分数 略 低于
决策 树 分类器 的 分数 。 这 可能 是 由于 随机 森林 算法 固有 的 随机性 ， 也 可能 是 决策 树 过
度 拟合 训练 数据 。

同样 重要 的 是 要 注意 ， 准确性 可能 不 是 这个 问题 的 最佳 指标 ， 特别 是 如果 目标 变量 中
的 类 不 平衡 的 话 。 其他 指标 （ 例如 精确率 、 召回率 或 F 1 分数 ） 可能 提供 更 多 信息 。

最后 ， 如前所述 ， 可以 处理 高基数 分类 特征 （ “ 演员 ” 和 “ 节目 类型 ” ） 和 文本 特征 （ “ 节
目 描述 ” ） 的 更 高级 模型 可能 能够 实现 更 好 的 性能 。 这样 的 模型 可能 涉及 用于 “ 描述 ” 特
征 的 自然 语言 处理 （ NLP ） 技术 ， 以及 用于 “ 演员 ” 和 “ 节目 类型 ” 特征 的 更 复杂 的 编码 方
法 。 然而 ， 开发 这样 的 模型 将 是 一 项 更 复杂 的 任务 ， 并且 超出 了 此 交互 的 范围 。

如果 您 想 进一步 操作 或 需要 其他 帮助 ， 请 告诉 我 。

总结 一下 ： 我 让 ChatGPT 创建 两 个 机器 学习 模型 ， 第一 个 内容 推荐 系统 对 它 而言 还是 比较 轻
松 的 ， 第二 个 预测 电影 评级 就 很 吃力 了 。 由于 沙盒 环境 的 限制 ， Code Interpreter 无法 导
入sklearn 的 category _ encodes 模块 。 在 建模 过程 中 ， 也 会 忘记 导入 关键 的 库 ， 虽然 它 自己
会 纠错 。

在 建立 预测 电影 评级 的 过程 中 ， 它 先 尝试 了 简单 的 决策 树 分类器 ， 但是 由于 加权 平均 精度
、 召回率 和 F 1 分数 都 不 太 理想 ， 又 尝试 了 随机 森林 分类器 。 然而 效果 并 不 理想 ， 需要 更
复杂 的 编码 方法 来 创建 更 高级 的 模型 ， 这些 已经 超出 Code Interpreter 的 能力 了 。

Code Interpreter 对 数据 分析 领域 的 影响

你 是 否 曾 听 过 一 句 话 — 人人 都 是 数据 分析师 。 在 ChatGPT 和 Code Interpreter 出现 之前 ， 我
们 离 这个 美好 的 愿望 还有 一 段 距离 。 但是 自从 Code Interpreter 出现 以后 ， 我 相信 这 句 话
不 再 是 一 句 口号 ， 而是 越 来 越 成为 现实 。

经过 以上 案例 的 测试 ， 我们 可以 看到 Code Interpreter 的 能力 。 我 用 来 测试 的 方法 已经 涉
及 专业 的 数据 分析 了 ， 但是 对 大多数 用 Excel 来 进行 数据 分析 的 人 而言 ， Code Interpreter
堪称 完美 。 大多数 日常 办公 涉及 的 数据 分析 对 Code Interpreter 来 说 根本 不在话下 。 你 可
以 直接 上 传Excel ， 通过 对话 的 方式 让 ChatGPT 帮 你 进行 数据 分析 ， 生成 各种 漂亮 的 图表 。

对于 专业 的 数据 分析 师 或者 数据 科学 家 而言 ， Code Interperter 依然 会 帮 你 做 很多 繁重 的
工作 。 你 需要 的 是 精通 统计学 ， 熟知 不 同 情景 下 的 数据 分析 方法 ， 这样 才 能 更 好 地 指导
Code Interpreter 完成 很多 复杂 的 工作 。 对于 更 复杂 的 涉及 机器 学习 建模 的 数据 分析 ，
Code Interpreter 就 比较 吃力 了 ， 所 能 提供 的 是 一些 基本 的 建模 和 思路 ， 由于 沙盒 环境 的
限制 ， 缺少 很多 必要 的 代码库 和 计算 资源 。

总 的 来说 ， 我们 能 看到 低 代码 在 数据 分析 领域 的 趋势 。 我们 会 越 来 越 少 地 亲自 写 代码 ， 更
多 地 是 管理 数据 分析 的 流程 ， 让 ChatGPT 这样 的 人工智能 工具 根据 我们 的 指导 来 分析 数据 。
我们 用 ChatGPT 帮 我们 省 下 来 的 时间 可以 去 熟悉 业务 ， 强化 数学 和 统计学 知识 ， 精通 机器 学
习建模 的 各个 环节 。

Code Interpreter 在 数据 分析 上 的 不足

虽然 Code Interpreter 在 数据 分析 方面 有 革命性 的 影响 ， 但是 还 存在 诸多 限制 ：

• 需要 Plus 账号 。 Code Interpreter 这个 OpenAI自研 的 功能 目前 只 对 Plus 会员 开放 ， 势
必 会 影响 它 的 大规模 普及 。 而且 就算 有 Plus 账号 的 话 ， 每 三 个 小时 50 条 会话 的 限制 对
于 一些 大型 的 项目 使用 起 来 不 太 方便 。
• 无法 联网 。 Code Interpreter 用 来 进行 分析 的 Python库 都 是 内置 在 沙盒 环境 中 的 ， 一
些 没有 内置 的 库 无法 通过 联网 下载 。 而且 如果 你 要 分析 的 话题 比较 新 ， 那 么 ChatGPT 由
于 缺乏 实时 的 知识 ， 可能 会 不 了解 你 的 项目 ， 从而 影响 判断 的 准确性 。
• 不 稳定 。 目前 它 对 你 上传 的 数据 所 记忆 的 时间 是 有 限制 的 ， 超过 了 时间 限制 你 可能 需
要 重新 上 传 数据 。 由于 模型 本身 的 随机性 ， 每次 它 的 分析 方法 可能 有 差异 。
• 缺少 一些 中文 支持 。 在 数据 分析 过程 中 ， 最 好 还是 用 英文 来 对话 ， 否则 可能 会 显示 不
正常 或者 分析 的 能力 会 不 如 英文 环境 。
• 机器 学习 能力 不 足 。 对于 常规 的 数据 分析 ， Code Interpreter 是 没有 问题 的 ， 但是 如
果 涉及 复杂 的 机器 学习 建模 ， 它 就 有些 吃力 了 。

我 的 总结

Code Interpreter 让 我们 仅仅 通过 对话 就 能 分析 庞大 而 复杂 的 数据 。 我们 更 需要 关注 的 是
如果 指导 这些 人工智能 工具 为 我们 处理 复杂 而 繁重 的 工作 ， 而 不 是 写 代码 本身 。

尽管 Code Interpreter 目前 存在 一些 限制 ， 但 它 无疑 是 一个 强大 的 工具 。 随着 它 的 不断 迭
代 ， 这些 限制 应该 也 会 越 来 越 少 。 代码 解释器 让 我们 离 每个 人 都 可以 成为 数据分 析师 的 未
来 又 近 了 一 步 。

如果 本文 对 你 有 帮助 ， 辛苦 帮 我 点 个 赞哦 🙏🏽

相关 阅读

• ChatGPT Plus 深度 体验 ： 你 是 否 要 升级 呢


avatar
我 的 AI力量 创作 等级L V . 3

27
文章

27 k
阅读

23
粉丝
目录
收起

• 如何 安装 Code Interpreter
• 数据 清理 和 预处理
• 探索性 数据 分析 ( EDA )
• 自然 语言 处理
• 时间 序列 分析
• 统计 推断
• 数据 挖掘
• 机器 学习 建模
• Code Interpreter 对 数据 分析 领域 的 影响
• Code Interpreter 在 数据 分析 上 的 不足
• 我 的 总结
• 相关 阅读

相关 推荐

如何 正确 使用 ChatGPT 的 Prompts
1 . 5 k 阅读
  ·  
2 点 赞

Prompt Tuning -- 让 人 工智能 更加 智能 的 秘密 武器
871 阅读
  ·  
0点 赞

ChatGPT Plus 深度 体验 ： 你 是 否 要 升级 呢
1 . 9k 阅读
  ·  
5 点 赞

ChatGPT 的 翻译 表现 以及 提示词 技巧
1 . 9k 阅读
  ·  
3 点 赞

提示词 （ prompt ） 工程 指南 （ 六 ） ： 对抗 提示
792 阅读
  ·  
2 点 赞
